{"title": "thoughts on javascript build tools", "slug": "thoughts-on-javascript-build-tools", "time": 1581518700000, "body": "<p>I don't think anyone likes javascript build tools. They are complex and frustrating to deal with.</p>\n<p>I love the idea of <a href=\"https://parceljs.org/\">parcel</a> and in theory you should be able to create an amazing build tool like that. But in practice, I think parcel just plain sucks. It is so full of bugs it is barely usable for a serious project. <a href=\"https://medium.com/@devongovett/parcel-2-0-0-alpha-1-is-here-8b160c6e3f7e\">Version 2</a> is on the way, but I've never been able to get it to work, and I believe I'm not the only one.</p>\n<p>Why are javascript build tools so complex? Isn't most of the complexity coming from importing non-javascript files from javascript. Is that complexity worth it? What if we stop the abomination that is importing images, css files etc. from javascript. Couldn't we hugely simplify our build process?</p>\n<p>As long as we stick to importing javascript from javascript we can simply call <code>sass --watch</code> for our css, <code>babel app.js</code> for our javascript, <code>elm make</code> if using elm, <code>dev-server ./static</code> for live-reloading, <code>uglifyjs app.js --compress --mangle</code> for javascript minification. No complex abstractions. No extra packages for each of your dependencies like <code>sass-loader</code>, <code>elm-webpack-loader</code>, <code>babel-loader</code> etc. when using webpack. No build tool messing up the errors/stacktraces from your tools/libraries.</p>\n<p>What I want from my build tool is:</p>\n<ul>\n<li>call multiple arbitrary shell commands in parallel and combine the output in a single terminal window</li>\n<li>offer the ability to watch files for changes and re-run commands on changes</li>\n<li>development webserver with support for live reloading of at least css changes</li>\n</ul>\n<p>You can kind of set this up yourself using multiple different npm packages, but it's a bit of work and the end result is not perfect either.</p>\n<ul>\n<li><a href=\"https://github.com/paulmillr/chokidar\">chokidar</a> for watching files.</li>\n<li><a href=\"https://www.npmjs.com/package/npm-run-all\">npm-run-all</a> for running multiple commands in parallel in the same terminal window.</li>\n<li><a href=\"https://www.npmjs.com/package/live-server\">live-server</a> for live-reloading</li>\n</ul>\n<p>Your package.json scripts field might look something like this (untested, probably has bugs)</p>\n<div class=\"codehilite\" style=\"background: #f8f8f8\"><pre style=\"line-height: 125%\"><span></span><code>{\n    <span style=\"color: #008000; font-weight: bold\">&quot;scripts&quot;</span>: {\n        <span style=\"color: #008000; font-weight: bold\">&quot;watch&quot;</span>: <span style=\"color: #BA2121\">&quot;npm-run-all --parallel watch:**&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;watch:css&quot;</span>: <span style=\"color: #BA2121\">&quot;sass --watch app/css:dev/css&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;watch:elm&quot;</span>: <span style=\"color: #BA2121\">&quot;chokidar &#39;**/*.elm&#39; -c &#39;elm make src/Main.elm --output dev/elm.js&#39; --initial&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;watch:javascript&quot;</span>: <span style=\"color: #BA2121\">&quot;babel app/app.js --watch --out-file dev/app.js&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;watch:server&quot;</span>: <span style=\"color: #BA2121\">&quot;cd dev &amp;&amp; live-server&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;build&quot;</span>: <span style=\"color: #BA2121\">&quot;npm-run-all --parallel build:**&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;build:css&quot;</span>: <span style=\"color: #BA2121\">&quot;sass --style=compressed app/css:build/css&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;build:elm&quot;</span>: <span style=\"color: #BA2121\">&quot;elm make src/Main.elm --optimize --output build/elm.js&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">&quot;build:javascript&quot;</span>: <span style=\"color: #BA2121\">&quot;babel app/app.js --out-file build/app.js&quot;</span>\n    }\n}\n</code></pre></div>\n\n\n<p>I'm probably overlooking some webpack feature that can't be replaced like this. Code splitting might be one, but if you're using something like <a href=\"https://elm-lang.org/\">Elm</a> or <a href=\"https://svelte.dev/\">Svelte</a> the output is so tiny compared to React/Vue/Angular that it doesn't really matter.</p>\n<p>There are some issues left, like combining your plain-javascript and elm-generated-javascript into a single file, but this is the build setup that I'm going to strive for from now on.</p>"}