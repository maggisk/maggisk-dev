{"title": "dangerouslySetInnerHTML in Elm", "slug": "dangerouslysetinnerhtml-in-elm", "time": 1581514080000, "body": "<p>I love the elm language, but sometimes I'm baffled by the decisions made by the authors. How can you have the skill and experience to create something like elm, yet <a href=\"https://github.com/elm/html/issues/172\">not realize</a> that there are plenty of valid reasons to want to render html provided by the server. Displaying html created using a rich text editor is one very common scenario. Every major web framework provides this feature, yet it was removed from elm.</p>\n<p>There are plenty of really ugly suggestions in that issue thread, yet no fully working code examples of how to solve this. So here it is, the least ugly solution using <a href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements\">custom elements</a>.</p>\n<p>Add this custom element to your javascript.</p>\n<div class=\"codehilite\" style=\"background: #f8f8f8\"><pre style=\"line-height: 125%\"><span></span><code><span style=\"color: #008000; font-weight: bold\">if</span> (<span style=\"color: #008000\">window</span>.customElements) {\n    customElements.define(\n        <span style=\"color: #BA2121\">&quot;elm-innerhtml&quot;</span>,\n        <span style=\"color: #008000; font-weight: bold\">class</span> ElmInnerHTML <span style=\"color: #008000; font-weight: bold\">extends</span> HTMLElement {\n            <span style=\"color: #008000; font-weight: bold\">static</span> get observedAttributes() {\n                <span style=\"color: #008000; font-weight: bold\">return</span> [<span style=\"color: #BA2121\">&quot;html&quot;</span>];\n            }\n\n            attributeChangedCallback(name, oldValue, newValue) {\n                <span style=\"color: #008000; font-weight: bold\">if</span> (name <span style=\"color: #666666\">==</span> <span style=\"color: #BA2121\">&quot;html&quot;</span>)\n                    <span style=\"color: #008000; font-weight: bold\">this</span>.innerHTML <span style=\"color: #666666\">=</span> newValue;\n            }\n        }\n    );\n}\n</code></pre></div>\n\n\n<p>And a wrapper function on the elm side to use it</p>\n<div class=\"codehilite\" style=\"background: #f8f8f8\"><pre style=\"line-height: 125%\"><span></span><code><span style=\"color: #008000; font-weight: bold\">import </span><span style=\"color: #0000FF; font-weight: bold\">Html</span> <span style=\"color: #19177C\">exposing</span> (<span style=\"color: #19177C\">node</span>)\n<span style=\"color: #008000; font-weight: bold\">import </span><span style=\"color: #0000FF; font-weight: bold\">Html.Attributes</span> <span style=\"color: #19177C\">exposing</span> (<span style=\"color: #19177C\">attribute</span>)\n\n\n<span style=\"color: #19177C\">dangerouslySetInnerHtml</span> <span style=\"color: #0000FF\">:</span> <span style=\"color: #B00040\">String</span> <span style=\"color: #0000FF\">-&gt;</span> <span style=\"color: #B00040\">Html</span> <span style=\"color: #19177C\">msg</span>\n<span style=\"color: #19177C\">dangerouslySetInnerHtml</span> <span style=\"color: #19177C\">html</span> <span style=\"color: #0000FF\">=</span>\n    <span style=\"color: #19177C\">node</span> <span style=\"color: #BA2121\">&quot;elm-innerhtml&quot;</span> [ <span style=\"color: #19177C\">attribute</span> <span style=\"color: #BA2121\">&quot;html&quot;</span> <span style=\"color: #19177C\">html</span> ] []\n</code></pre></div>\n\n\n<p>Works in every major browser except IE11 and below.</p>"}